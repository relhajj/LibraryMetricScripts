p: Project = input;
Total: output sum of int;

hasLib: bool = false;

visit(p, visitor {
    before n: Project -> ifall (i: int; !match(`^java$`, lowercase(n.programming_languages[i]))) stop;
	before node: CodeRepository -> {
		# only look at the latest snapshot
		# and only include Java files
		snapshot := getsnapshot(node, "SOURCE_JAVA_JLS");
		foreach (i: int; def(snapshot[i]))
			visit(snapshot[i]);
	}
	before node: ASTRoot -> {
		if (!hasLib) {
		    foreach (i: int; def(node.imports[i]))
            #API name should be here (e.g. java.util.)
		        if(strfind("java.util.", node.imports[i]) == 0) {
			        hasLib = true;
			        break;
		        }
		} else stop;
	}
	before _ -> if (hasLib) stop;
});

if (hasLib) Total << 1;
